# 基础知识

Linux系统一般有4个主要部分：内核、shell、文件系统和应用程序。

Linux内核主要由五个子系统组成：进程调度，内存管理，虚拟文件系统，网络接口，进程间通信。

操作系统 = 内核 + 系统程序

系统程序 = 编译环境 + 应用程序接口 + 用户接口

编译环境 = 编译程序 + 连接程序 + 装载程序

### 进程状态

Liunx 中进程有哪几种状态？在 ps 显示出来的信息中，分别用什么符号表示的？
 **答案：**
 （1）不可中断状态：进程处于睡眠状态，但是此刻进程是不可中断的。不可中断， 指进程不响应异步信号。
 （2）暂停状态/跟踪状态：向进程发送一个 SIGSTOP 信号，它就会因响应该信号 而进入 TASK_STOPPED 状态;当进程正在被跟踪时，它处于 TASK_TRACED 这个特殊的状态。
 “正在被跟踪”指的是进程暂停下来，等待跟踪它的进程对它进行操作。 

 （3）就绪状态：在 run_queue 队列里的状态 

（4）运行状态：在 run_queue 队列里的状态
 （5）可中断睡眠状态：处于这个状态的进程因为等待某某事件的发生（比如等待 socket 连接、等待信号量），而被挂起
 （6）zombie 状态（僵尸）：父亲没有通过 wait 系列的系统调用会顺便将子进程的尸体（task_struct）也释放掉
 （7）退出状态 

>  D 不可中断 Uninterruptible（usually IO）
>  R 正在运行，或在队列中的进程
>  S 处于休眠状态
>  T 停止或被追踪
>  Z 僵尸进程
>  W 进入内存交换（从内核 2.6 开始无效）
>  X 死掉的进程

# Linux文件系统

 bin：二进制，可执行文件  sbin：系统二进制文件  opt：随意 ，一般为浏览器安装的软件  boot：启动  dev：device 磁盘等   etc：配置文件  tmp：临时文件  lib：依赖   media：自动挂载的设备（如U盘等） mnt：手动挂载  

proc：进程     var：存储日志（log）信息   run和sys：（内存中）用来存储某些程序的运行时信息和系统需要的一些信息

![1](https://mmbiz.qpic.cn/mmbiz_png/map09icNxZ4mq2ib4IZhk9WZoBw6MbsUn5JZ75gYZItVKdrduwlknfJbNha5oTSNLcDIUtBPINibdqBCDyjZOH0LQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)



终端：/dev/tty      黑洞文件： /dev/null

通配符： ‘？’ ：代替任意单个字符       ‘*’： 代替任意多个字符   方括号“[charset]”可替代 charset 集中的任何单个字符，如[a-z]，[abABC]

标准输入:如 管道符(输出做输入) | 、 文件重定向 >  、<

参数 ：变量：$

|  	|代码	|运算符    |
| --|--|-- |
|标准输入 (stdin)|	0	|< 或 <<
|标准输出 (stdout)|	1	|> 或 >>
|标准错误输出 (stderr)|	2	|2> 或 2>> 



**对于`$`，`(`，`)`这几个符号，单引号包围的字符串不会做任何转义，双引号包围的字符串会转义**。

# Linux命令

Ctrl+shift+v：复制  （跨平台）

服务器后台运行，不退出  （  cmd &）

​       &表示该进程不阻塞，而（  cmd &）则是将`cmd`命令挂到一个`systemd`系统守护进程名下

   nohup：系统后台不挂断地运行命令，退出终端不会影响程序的运行。

#### grep

grep: 查找  使用正则表达式搜索文本
grep [options] PATTERN [FILE...]
•	PATTERN 是查找条件：可以是普通字符串、可以是正则表达式，通常用单引号将RE括起来。
•	FILE 是要查找的文件，可以是用空格间隔的多个文件，也可是使用Shell的通配符在多个文件中查找PATTERN，省略时表示在标准输入中查找。
•	grep命令不会对输入文件进行任何修改或影响，可以使用输出重定向将结果存为文件

```shell
-c ： 统计匹配到行的个数
-i ： 忽略大小写
-n ： 输出行号  匹配内容  
-v ： 反向选择，去掉 匹配内容，也就是显示出没有 搜寻字符串 内容的那一行
--color=auto ：找到的关键字加颜色显示
```





#### awk

> awk '{pattern + action}' {filenames}
>
> awk 每次处理一行，处理的最小单位是字段，每个字段的命名方式为：$n，n 为字段号，从 1 开始，$0 表示一整行。
>
> 变量：NF	每一行拥有的字段总数、NR	目前所处理的是第几行数据、FS	目前的分隔字符，默认是空格键
>
> \#cat /etc/passwd |awk -F ':' '{print 1"\t"1"\t"7}' //-F 的意思是以':'分隔 root /bin/bash
> daemon /bin/sh 搜索/etc/passwd 有 root 关键字的所有行 

>  \#awk -F: '/root/' /etc/passwd root❌0:0:root:/root:/bin/bash

#### sed



echo: 输出显示（字符串）



wc :统计指定文件中的字节数、字数、行数, 并将统计结果显示输出

 		  -c 统计字节数;   -l 统计行数;  -w 统计字数。

seq：**用于生成从一个数到另一个数之间的所有整数。**  

​              **seq [选项]... 首数 增量 尾数**



查找自己所在的终端信息：who am i

查看当前谁在使用该主机：who

```
            $0   #  本身脚本的启动名(包括路径)
            $n   #  第n个参数,n=1,2,…9
            $*   #  所有参数列表(不包括脚本本身)
            $@   #  所有参数列表(独立字符串)
            $#   #  参数个数(不包括脚本本身)
            $$   #  当前程式的PID
            $!   #  执行上一个指令的PID
            $?   #  执行上一个指令的返回值  0：正确执行
```





- history: \# 查看历史命令 保留1000个历史命令，超出会将最老的删除

####  cron

定时服务： 

```shell
minute hour day-of-month month-of-year day-of-week commands
合法值 00-59 00-23 01-31 01-12 0-6 (0 is sunday)
```



### 文件管理

三种身份进行文件的存取：owner/group/others，对文件的操作权限有read/write/execute等
r: 4, w: 2, x: 1   -：无权限    

- 文件默认权限：文件默认没有可执行权限，因此为 666，也就是 -rw-rw-rw- 。
- 目录默认权限：目录必须要能够进入，也就是必须拥有可执行权限，因此为 777 ，也就是 drwxrwxrwx。

|      | r            | w                         | x              |
| ---- | ------------ | ------------------------- | -------------- |
| 文件 | 读取文件     | 编辑文件                  | 执行可执行文件 |
| 目录 | 列出目录内容 | 移动、建立、删除文件/目录 | 进入目录       |

| 第一个符号 | 文件类型:        |
| ---------- | :--------------- |
| -          | `常规文件`       |
| d          | `目录`文件       |
| l          | 符号`链接文件`   |
| c          | 字符特殊设备文件 |
| b          | 模块特殊设备文件 |
| p          | FIFO管道文件     |
| s          | 套接字文件       |



| 命令  |含义  |
|--|--|
| touch | `创建文件。`如果文件不存在，则创建一个新的文件，如果文件已存在，则会修改文件的`时间戳`。 |
| cat | 连接文件并打印到标准输出设备： cat -A xxx 打印到屏幕      /etc/issue : 查看发行版本  既可接受`标准输入`，也可接受命令行`参数`   -n ：打印出行号，连同空白行也会有行号，-b 不会 |
| tac | cat 的反向操作，`从最后一行开始打印` |
|more | `分页`显示文件内容 |
| less | 与more相似，分行显示，但可以`向前翻页` |
| ctrl + c | 彻底退出当前命令 |
| ctrl + z | 挂起当前进程fg 恢复后台 |
|chmod|更改文件权限：chmod+xxx+文件名     777  最高|
|chown|更改文件拥有者|
|chgrp|更改文件群组|
|head|- n 查看前 多少行，可以指定行数|
|tail |仅查看尾部，可以指定行数。   tail -n 5 nowcoder.txt  打印文件的后 5行 |
|sed |- 查看中间 某段    sed -m |
| find  |在指定目录下查找命令    find / -name targetfilename <br>  find html/ -mtime 0 ：查找最近24小时内修改的文件    atime: 访问    ctime：变更时间  |
| whereis |文件搜索  加参数与文件名，只能查二进制文件、说明文档，源文件等 |
| which |只能查可执行文件  指令搜索     -a ：将所有指令列出，而不是只列第一个 |
| locate |- filename |
| find |文件搜索    -mtime n:  n天前的那一天修改的文件 |
| alias |取别名 |
|  mv |为文件和目录`改名`或`移动`  -f 强制  |
|  cp |复制文件或目录    、 scp：基于 ssh 登陆进行安全的远程文件拷贝命令  |
|rm|删除文件或目录   -r 递归删除|
|free|查看内存使用  及交换区 的容量大小|
|scp|`远程文件拷贝`，rcp的加密版；两台主机间传输文件|
|wget|wget url 下载网上文件  / wget -O xx url 指定文件名 |

```
从本地复制到远程，指定了文件夹  （-r 递归复制整个目录）
scp local_file remote_username@remote_ip:remote_folder

从远程复制到本地
scp （-r） remote_username@remote_ip:remote_folder local_folder
```

类似创建快捷方式

硬链接：通过索引节点进行。源文件删除不会失效（还可以通过其他文件名找到）   多个文件名指向同一个inode-number    。 命令： ln link source

软连接：存放的内容是另一文件的路径名的指向。源文件删除失效   ln  -s slink source



### 磁盘管理

| 命令  |含义  |备注|
|--|--|--|
|  cd |切换当前工作目录  |~ /根目录、. /当前目录，../ 上层目录|
| pwd |查看当前路径 ||
|df|显示文件系统`磁盘`使用情况||
|du|显示目录或文件的大小||
|iostat|查看磁盘IO||
|mkdir|创建目录|-p 递归创建目录   -m ：配置目录权限|
|tree|以树状图列出目录内容|-a 显示所有文件和目录、-d 显示目录名称而非内容|
|rmdir|删除空目录|目录必须为空   -p 递归删除目录|
|ls|显示工作目录下的内容|-a 显示所有文件及目录、-l 显示文件权限，大小和拥有者等信息、-r 递归显示|

### 网络通信

| 命令  |含义  |备注|
|--|--|--|
|  telnet |远端登录|-a 尝试自动登录、-d 启动排错模式、-K 不自动登录|
|ifconfig|显示或设置网络设备|add 设置 IP 地址、del 删除 IP 地址、up 启动指定网络设备|
|ping|使用 ICMP，若远端主机无问题会得到回应|-i 指定间隔秒数、-R 记录路由过程、-t 设置 TTL 大小|
|netstat|显示网络状态、查看占用端口的进程|-a 显示所有 socket、-c 持续列出网络状态、-t 显示 TCP 状况 （-napt）、-u 显示 UDP 状况|
|ifstat|查看网络IO||
|route | -n 查看当前系统的路由表||


### 系统管理
| 命令  |含义  |备注|
|--|--|--|
| env |查看 环境变量 ||
|exit|`退出`目前的shell终端  ||
|top|实时显示进程状态(CPU、内存使用率)|-n 设置更新次数、-d 设置更新时间、-p 指定进程号<br>top -d 2   两秒钟刷新一次|
|sar|输出CPU信息||
|vmstat|展现给定时间间隔的服务器的状态值,包括服务器的`CPU使用率，内存使用，虚拟内存交换情况,IO读写情况`||
|ps|显示`当前进程`的状态|-A 列出所有进程、-u 指定用户、-w 加宽显示、pri：优先级<br> ps -ef \|grep pid <br>aux  查看系统所有进程|
|pstree|查看进程树||
| w / uptime | 1分钟，5分钟，15分钟内的系统平均负载 |      |
| job |  | job -l  查看后台任务 |
| fg | 后台任务调到前台执行 |  |
| bg | 把停下的后台任务在后台执行起来 |  |
| kill | 终止进程 | kill [-s <信息名称或编号>][程序] 或 kill [-l <信息编号>]      kill -9 pid 强制关闭( SIGKILL 信号)   -15 释放资源关闭  ( SIGTERM 信号) |




- 平均负载：**当前系统正在运行的和处于等待运行的进程数之和**。也指的是处于**可运行状态**和  **不可中断状态**的平均进程数

- CPU利用率：当前**正在运行**的进程实时占用CPU的百分比，他是对一段时间内CPU使用状况的统计。

> CPU负载很高，利用率却很低，说明处于等待状态的任务很多，负载越高，代表可能很多僵死的进程。通常这种情况是IO密集型的任务，大量请求在请求相同的IO，导致任务队列堆积。
>
> 负载很低，利用率却很高。表明任务的执行时间很长，计算密集型任务。（top查看使用率最高的任务）

### 系统设置

| 命令 |	含义 |	备注|
|--|--|--|
|clear| 清除屏幕|-e 指定使用期限|
|rpm |管理套件	|-a 查询所有套件、-d 只列出文本文件|
|passwd|	更改使用者密码	|-d 删除密码、-l 停止账号使用、-S 显示密码信息|
|time|	测量指令消耗的时间和资源 |	-o 将输出写入指定文档|





### 备份压缩

| 命令 | 含义 | 备注 |
| ---- | ---- | ---- |
| tar  | 将多个文件打包成一个并压缩  |-z 调用 gzip 压缩、-j 调用 bzip2 压缩、-x 解压 -c打包 -v显示打包文件过程 -f指定压缩文件名|

tar -cv-f xx.tar 文件来打包，解压则使用 tar -xv-f xx.tar

编译文件：gcc -o fork fork.c   链接：./fork(当前目录）  上一级目录../
Shell 编译脚本文件：chmod +x test.sh


	shell中：
	exit（0）：正常运行程序并退出程序；
	exit（1）：非正常运行导致退出程序；
	
	exit 0 可以告知你的程序的使用者：你的程序是正常结束的。如果 exit 非 0 值，那么你的程序的使用者通常会认为你的程序产生了一个错误。
	在 shell 中调用完你的程序之后，用 echo $? 命令就可以看到你的程序的 exit 值。在 shell 脚本中，通常会根据上一个命令的 $? 值来进行一些流程控制。

### 关机
关闭电源：poweroff   
关闭：halt    -p:关闭系统并关闭电源
shutdown -h now ： 现在关机    -r：重启  -k：发送警告

# 题目

还不会的：

- 找出 一个文件夹下 所有文件中  包含 特定字符串的次数`	`
